#### 协同过滤

* **基于用户的协同过滤推荐**

  * 找到和目标用户兴趣相似的用户集合。

  * 找到这个集合中的用户喜欢的，且目标用户没有听说过的物品推荐给目标用户。

  * 算法流程：

    ![image-20220228101157727](C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20220228101157727.png)

    * **寻找偏好相似的用户**：通过皮尔逊相关度评价对用户进行分组。
    * **为相似的用户提供推荐物品：**在为相似的用户提供推荐物品时，采用加权排序推荐。

* **基于物品的协同过滤推荐**

  * 计算物品之间的相似度

  * 根据物品的相似度和用户的历史行为给用户生成推荐列表

  * 算法流程：

    **将【用户-内容】进行转置【内容-用户】**

    * **寻找相似的物品：**通过皮尔逊相关度评价对商品进行分组。
    * **为用户提供基于相似物品的推荐：**在为用户提供推荐相似的物品时，采用加权排序推荐。

* **基于模型的协同过滤推荐**

  * 基于样本的用户偏好信息，训练一个推荐模型，然后根据实时的用户喜好的信息进行预测，计算推荐。
  * 将评分离散化，转化成分类问题。

* **推荐系统中的Embedding**

  * **User Embedding：**为了使新闻和用户可以在相同的向量空间下做运算，**需要做用户做Embedding处理**，前期主要是从用户画像中筛选出一些在排序模型中重要性较大的特征做向量化**（通过特征重要度分析，发现标签（tag），媒体号（mid），一级分类（cat1），二级分类（cat2），主题（topic）等特征对于用户是否点击某篇文章的影响最大）**，利用Bert+LSTM对用户行为序列进行建模
  * **以电商举例：会直接对商品ID做Embedding，其训练的预料来至于用户的行为日志，故这个空间是用户的兴趣点组成。【行为日志的类型不同，表达的兴趣也不同，比如点击行为、购买行为、表达的用户兴趣不同】**【商品Embedding向量最终的作用，是不同商品在用户兴趣空间中位置表达】

* **Airbnb推荐算法解析**

  * **房源Embedding：把每个用户连续点击过得房源试做一个句子，每个房源当做word，训练出房源的embedding**

    * 对每个登录用户，将所有点击过的房源当做一个点击回话click session，并且按照时间先后做排序。如果两次点击之间超过30分钟，则将会话进行分割，分割成若干条会话。去掉会话中的误点击和时间比较短的点击，具体操作时过滤掉查看时长在30秒之内的房源记录。最后只保留房源数量大于等于2的会话记录，构成会话训练集S。所有的会话记录分成两类，**一类是以预定房源作为终止的，即预定会话（booked session）；二类不包含房源预定的，即查看会话（exploratory session）**
    * 训练数据采用的是滑动时间窗口的方式生成，时间跨度为几个月，采用最近几个月的数据，不断加入新数据，丢掉旧数据，每天都对所有的数据进行一次全量的离线训练。**（所以每天的房源embedding都会变化）**

  * **新启动：**

    * 房主上传新房源时需要上传3个特征，位置、价格、房源类型，在和新上传房源具有相同类型和相同价格区间的房源中，找到3个地理位置最接近的房源，用这3个房源的embedding求平均作为新房源的embedding。**（通过特征聚合，然后平均）**

  * **不再对单独的每一个房源学习一个embedding，而是根据特征对房源进行归类，对每个房源类型学习到embedding（对用户做归类，学习用户类型的embedding）**

    * **在同一个向量空间中训练房源类型和用户类型的embedding。用户的每次预定，都过程一个元祖（user_type，listing_type），包含用户类型和房源类型。将每个用户的所有预定的元组，按照时间顺序排列生成预定会话session**

  * **房源搜索排序：**

    * **将房源搜索排序问题当做一个回归问题：**

      * 输入特征包括：**房源特征、用户特征、搜索特征、交叉特征**

        * **房源特征：**价格、房源类型、房间数目、拒绝率等
        * **用户特征：**平均预定价格等
        * **查询特征：**入住人数、租住天数等
        * **交叉特征：**是多个特征的组合，包括搜索位置和房源位置的距离，入住人数和房源容纳人数的差异，房源价格和用户历史预定的平均价格的差异等

        